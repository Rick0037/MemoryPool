# 高并发内存池 MemoryPool

### 1.项目概述
在日常生活中操作系统的内存申请往往需要频繁的进行用户态和内核态之间的来回切换  
多线程的内存申请还涉及到锁竞争的问题，内存申请和锁竞争也被称为高性能服务器的四大杀手之二  
进行频繁的内存申请和释放过程会制造很多的内存碎片，（内部碎片和外部碎片）  
为了解决整个问题需要用到经典的池化技术配合，解除锁对线程的限制，由此影响设计了高并发内存池

### 2.层次结构
主要由三部分组成：  
ThreadCache线程缓存 负责每个单一线程的申请操作，在小于64k的情况下，从这里申请内存并不需要加锁
每个线程独立享有一个cache，这也是高并发线程池高效的地方。  
CentralCache中心缓存 中心缓存是所有线程所共享，线程缓存按需从中心缓存获取对象，并周期性回收，避免一个线程占用了太多的内存  
达到内存分配在多个线程中均衡的目的。中心缓存是存在竞争的，所以从这里取内存对象是需要加锁。  
PageCache页缓存 页缓存是中心缓存上面的缓存，以页为单位存储及分配，中心缓存没有内存对象(Span)时，从页缓存分配出一定数量的page，切割并分配给中心缓存。  
页缓存还会定期回收内存并合并成相邻的页，组成更大的页，缓解内存碎片的问题。  
![}2(1DHQ22}00IWE 3A0}3KU](https://user-images.githubusercontent.com/86883267/129190000-eb040b81-a471-490c-a881-4e0ea539a470.png)  


### 3.PageCache

### 4.CentralCache

### 5.PageCache

### 6.实现细节

### 7.测试结果展示

### 8.目录文件结构
ThreadCache.cpp	  线程缓存
ThreadCache.h     
CentralCache.cpp   中心缓存
CentralCache.h	    
PageCache.cpp	    页缓存
PageCache.h         
Common.h	    基础组件
ConcurrentAlloc.h    对外接口
